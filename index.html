<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO-теги -->
    <meta name="description" content="ImageOpt Pro - online image optimization and compression. Reduce size of JPG, PNG, WebP, AVIF without quality loss. Free photo compression tool.">
    <meta name="keywords" content="image optimization, photo compression, reduce image size, image converter, picture optimizer, JPG compression, PNG compression, webp optimization">
    <meta name="author" content="ImageOpt Pro Team">
    
    <link rel="canonical" href="https://imageopt-pro.com/">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="ImageOpt Pro - Online Image Optimizer">
    <meta property="og:description" content="Free tool for compressing and optimizing images. Reduce file sizes without quality loss!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://imageopt-pro.com/">
    <meta property="og:image" content="https://imageopt-pro.com/preview.jpg">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ImageOpt Pro - Image Optimizer">
    <meta name="twitter:description" content="Optimize images online for free. Reduce file sizes of JPG, PNG, WebP, AVIF while preserving quality.">
    <meta name="twitter:image" content="https://imageopt-pro.com/twitter-preview.jpg">
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "ImageOpt Pro",
        "description": "Free online tool for image optimization and compression",
        "applicationCategory": "Multimedia",
        "operatingSystem": "Windows, macOS, Linux, Android, iOS",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.8",
            "reviewCount": "124"
        }
    }
    </script>
    
    <title>ImageOpt Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Cropper.js CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-left">
                <div class="logo">
                    <i class="fas fa-image"></i>
                </div>
                <div class="header-text">
                    <h1>ImageOpt Pro</h1>
                    <div class="subtitle">Advanced Image Optimization</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="history-toggle" id="historyToggle" title="Processing history">
                    <i class="fas fa-history"></i>
                </button>
            </div>
            <div class="user-info">
                <div id="premiumStatus" class="premium-badge">Basic</div>
                <div id="dailyCounter" class="daily-counter">
                    <i class="fas fa-images"></i>
                    <span id="dailyCount">0</span>/<span id="dailyLimit">15</span>
                </div>
                <div class="premium-tooltip-container">
                    <button id="upgradeBtn" class="btn-premium">
                        <i class="fas fa-crown"></i> Premium
                    </button>
                </div>
                <span id="userEmail" style="margin: 0 10px; color: white;"></span>
                <button id="logoutBtn" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </button>
            </div>
        </header>

        <div class="main-grid">
            <div class="card">
                <div class="section-title">
                    <i class="fas fa-upload"></i>
                    <h2>Upload Images</h2>
                </div>
                
                <!-- Обновленное информационное сообщение -->
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    You can upload up to 15 images at once. Supported formats: JPG, PNG, WebP, AVIF, HEIC, TIFF.
                </div>
                
                <div class="upload-area" id="uploadArea">
                    <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                    <div class="upload-text">Drag & drop images here</div>
                    <div class="upload-subtext">or click to select files</div>
                </div>
                <input type="file" id="fileInput" accept="image/*,.heic,.heif,.tiff,.tif" multiple>
                
                <div class="file-previews" id="filePreviews"></div>
                
                <div class="section-title" style="margin-top: 30px;">
                    <i class="fas fa-edit"></i>
                    <h2>Edit Mode</h2>
                </div>
                
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    Select edit mode: apply changes to all images or only to the current one.
                </div>
                
                <div class="batch-controls">
                    <div class="batch-btn" id="editSingleBtn">
                        <i class="fas fa-file-image"></i> Edit Single
                    </div>
                    <div class="batch-btn active" id="editAllBtn">
                        <i class="fas fa-layer-group"></i> Apply to All
                    </div>
                </div>
                <div class="batch-edit-notice" id="batchEditNotice">
                    <i class="fas fa-info-circle"></i> Changes applied to all images
                </div>
                
                <!-- Image editor -->
                <div class="editor-container" id="editorContainer">
                    <div class="section-title">
                        <i class="fas fa-crop-alt"></i>
                        <h2>Image Editor</h2>
                    </div>
                    
                    <div class="info-box">
                        <i class="fas fa-info-circle"></i>
                        Use the tools below to edit the image. Changes are only displayed in the preview.
                    </div>
                    
                    <div class="editor-preview">
                        <img id="previewImage" src="" alt="Preview">
                        <div class="crop-overlay" id="cropOverlay"></div>
                    </div>
                    
                    <div class="edit-notification" id="editNotification">
                        <i class="fas fa-info-circle"></i> Changes are only displayed in preview
                    </div>
                    
                    <div class="editor-controls">
                        <div class="editor-btn" id="cropBtn">
                            <i class="fas fa-crop-alt"></i>
                            <span>Crop</span>
                        </div>
                        <div class="editor-btn" id="rotateLeftBtn">
                            <i class="fas fa-undo"></i>
                            <span>Rotate Left</span>
                        </div>
                        <div class="editor-btn" id="rotateRightBtn">
                            <i class="fas fa-redo"></i>
                            <span>Rotate Right</span>
                        </div>
                        <div class="editor-btn" id="flipHBtn">
                            <i class="fas fa-arrows-alt-h"></i>
                            <span>Flip</span>
                        </div>
                        <div class="editor-btn" id="adjustBtn">
                            <i class="fas fa-adjust"></i>
                            <span>Adjust</span>
                        </div>
                        <!-- Добавленная кнопка Auto -->
                        <div class="editor-btn" id="autoAdjustBtn">
                            <i class="fas fa-magic"></i>
                            <span>Auto</span>
                        </div>
                        <div class="editor-btn" id="resetEditBtn">
                            <i class="fas fa-times"></i>
                            <span>Reset</span>
                        </div>
                    </div>
                    
                    <!-- Ваш добавленный блок информации -->
                    <div class="info-box" style="margin-top: 10px; font-size: 0.9rem;">
                        <span class="explanation-icon">i</span>
                        Auto adjustment applies moderate enhancements. For best results, 
                        manually fine-tune after using auto mode.
                    </div>
                    
                    <!-- Touch controls for mobile -->
                    <div class="touch-controls">
                        <div class="touch-btn" id="touchRotateLeft">
                            <i class="fas fa-undo"></i>
                        </div>
                        <div class="touch-btn" id="touchRotateRight">
                            <i class="fas fa-redo"></i>
                        </div>
                        <div class="touch-btn" id="touchFlipH">
                            <i class="fas fa-arrows-alt-h"></i>
                        </div>
                        <div class="touch-btn" id="touchCrop">
                            <i class="fas fa-crop-alt"></i>
                        </div>
                        <div class="touch-btn" id="touchAdjust">
                            <i class="fas fa-adjust"></i>
                        </div>
                        <!-- Добавленная кнопка Auto для мобильных -->
                        <div class="touch-btn" id="touchAutoAdjust">
                            <i class="fas fa-magic"></i>
                        </div>
                    </div>
                    
                    <!-- Crop controls (обновленная версия) -->
                    <div class="crop-controls" id="cropControls">
                        <div class="crop-header">
                            <h3><i class="fas fa-crop-alt"></i> Crop Image</h3>
                            <div class="crop-actions">
                                <button class="btn" id="applyCropBtn">
                                    <i class="fas fa-check"></i> Apply
                                </button>
                                <button class="btn btn-secondary" id="cancelCropBtn">
                                    <i class="fas fa-times"></i> Cancel
                                </button>
                            </div>
                        </div>
                        
                        <div class="crop-ratios">
                            <div class="crop-ratio active" data-ratio="free">
                                <i class="fas fa-vector-square"></i> Free
                            </div>
                            <div class="crop-ratio" data-ratio="1:1">
                                <i class="fas fa-square"></i> 1:1
                            </div>
                            <div class="crop-ratio" data-ratio="4:3">
                                <i class="fas fa-rectangle-portrait"></i> 4:3
                            </div>
                            <div class="crop-ratio" data-ratio="16:9">
                                <i class="fas fa-desktop"></i> 16:9
                            </div>
                            <div class="crop-ratio" data-ratio="9:16">
                                <i class="fas fa-mobile-alt"></i> 9:16
                            </div>
                            <div class="crop-ratio" data-ratio="5:7">
                                <i class="fas fa-camera"></i> 5:7
                            </div>
                        </div>
                        
                        <div class="crop-tips">
                            <i class="fas fa-info-circle"></i>
                            Drag to move, drag corners to resize, scroll to zoom
                        </div>
                    </div>
                    
                    <!-- Adjustment controls -->
                    <div class="adjust-controls" id="adjustControls">
                        <h3 class="card-title"><i class="fas fa-sliders-h"></i> Image Adjustments</h3>
                        
                        <div class="adjust-row">
                            <label>Brightness</label>
                            <input type="range" id="brightnessRange" min="-100" max="100" value="0">
                            <span id="brightnessValue">0%</span>
                        </div>
                        <div class="adjust-row">
                            <label>Contrast</label>
                            <input type="range" id="contrastRange" min="-100" max="100" value="0">
                            <span id="contrastValue">0%</span>
                        </div>
                        <div class="adjust-row">
                            <label>Saturation</label>
                            <input type="range" id="saturationRange" min="-100" max="100" value="0">
                            <span id="saturationValue">0%</span>
                        </div>
                        <div class="adjust-row">
                            <label>Sharpness</label>
                            <input type="range" id="sharpnessRange" min="0" max="100" value="0">
                            <span id="sharpnessValue">0%</span>
                        </div>
                        <div class="adjust-row">
                            <label>Temperature</label>
                            <input type="range" id="temperatureRange" min="-100" max="100" value="0">
                            <span id="temperatureValue">0%</span>
                        </div>
                        
                        <div class="adjust-actions">
                            <button class="btn" id="applyAdjustBtn">
                                <i class="fas fa-check"></i> Apply
                            </button>
                            <button class="btn btn-secondary" id="resetAdjustBtn">
                                <i class="fas fa-times"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Watermarks - ОБНОВЛЕННЫЙ БЛОК -->
                <div class="watermark-controls" id="watermarkControls">
                    <h3 class="card-title"><i class="fas fa-water"></i> Watermark</h3>
                    
                    <!-- Переключатель типа -->
                    <div class="watermark-type-toggle">
                        <button class="watermark-type-btn active" data-type="text">Text</button>
                        <button class="watermark-type-btn" data-type="image">Image</button>
                    </div>
                    
                    <!-- Текстовый водяной знак -->
                    <div class="watermark-text-section">
                        <div class="watermark-row">
                            <input type="text" id="watermarkText" placeholder="Watermark text">
                            <input type="color" id="watermarkColor" value="#ffffff">
                        </div>
                        <div class="watermark-row">
                            <label>Size:</label>
                            <input type="range" id="watermarkSize" min="10" max="50" value="24">
                            <span id="watermarkSizeValue">24px</span>
                        </div>
                    </div>
                    
                    <!-- Изображение водяного знака -->
                    <div class="watermark-image-section" style="display: none;">
                        <div class="watermark-row">
                            <input type="file" id="watermarkImageInput" accept="image/*">
                        </div>
                        <div class="watermark-row">
                            <label>Scale (%):</label>
                            <input type="range" id="watermarkImageScale" min="5" max="50" value="20">
                            <span id="watermarkImageScaleValue">20%</span>
                        </div>
                    </div>
                    
                    <!-- Общие настройки -->
                    <div class="watermark-row">
                        <label>Opacity:</label>
                        <input type="range" id="watermarkOpacity" min="10" max="100" value="70">
                        <span id="watermarkOpacityValue">70%</span>
                    </div>
                    
                    <div class="watermark-row">
                        <label>Position:</label>
                        <select id="watermarkPosition">
                            <option value="bottom-right">Bottom Right</option>
                            <option value="bottom-left">Bottom Left</option>
                            <option value="top-right">Top Right</option>
                            <option value="top-left">Top Left</option>
                            <option value="center">Center</option>
                        </select>
                    </div>
                    
                    <div class="watermark-preview">
                        <span id="watermarkPreview">Watermark Preview</span>
                        <img id="watermarkImagePreview" style="display: none; max-width: 100%; max-height: 100px;">
                    </div>
                </div>
                
                <div class="section-title">
                    <i class="fas fa-sliders-h"></i>
                    <h2>Optimization Settings</h2>
                </div>
                
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    Configure compression settings to achieve the optimal balance between quality and file size.
                </div>
                
                <div class="controls">
                    <div class="control-group">
                        <div class="control-label">
                            <span class="control-label-text">Quality:</span>
                            <span class="quality-value control-value" id="qualityValue">80%</span>
                        </div>
                        <input type="range" id="quality" min="10" max="100" value="80">
                        <div class="info-box" style="margin-top: 10px; font-size: 0.9rem;">
                            <span class="explanation-icon">i</span>
                            Higher quality = larger file size. We recommend 60-80% for optimal results.
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <span class="control-label-text">Output Format:</span>
                        </div>
                        <select id="format">
                            <option value="jpeg">JPEG</option>
                            <option value="png">PNG</option>
                            <option value="webp">WebP</option>
                            <option value="avif">AVIF</option>
                        </select>
                        <div class="info-box" style="margin-top: 10px; font-size: 0.9rem;">
                            <span class="explanation-icon">i</span>
                            WebP and AVIF provide the best compression without quality loss.
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <div class="control-label">
                            <span class="control-label-text">Max Width (px):</span>
                        </div>
                        <select id="maxWidth">
                            <option value="">No resize</option>
                            <option value="640">640px (for mobile)</option>
                            <option value="800">800px (for tablets)</option>
                            <option value="1024">1024px (for laptops)</option>
                            <option value="1200">1200px (for monitors)</option>
                            <option value="1920">1920px (4K)</option>
                        </select>
                        <div class="info-box" style="margin-top: 10px; font-size: 0.9rem;">
                            <span class="explanation-icon">i</span>
                            Reducing width significantly decreases file size.
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label for="auto-optimize">Auto Optimization</label>
                        <div class="auto-optimize">
                            <input type="checkbox" id="autoOptimizeCheckbox">
                            <span>Optimize immediately after upload</span>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced settings -->
                <div class="settings-toggle">
                    <button class="settings-toggle-btn" id="toggleAdvancedSettings">
                        <i class="fas fa-cog"></i> Advanced Settings
                    </button>
                </div>
                
                <div class="advanced-settings" id="advancedSettings">
                    <div class="control-group">
                        <label>Advanced JPEG Settings</label>
                        <div class="progressive-toggle">
                            <input type="checkbox" id="progressiveJpeg">
                            <span>Progressive JPEG (better quality)</span>
                        </div>
                        <div class="metadata-toggle">
                            <input type="checkbox" id="removeMetadata" checked>
                            <span>Remove metadata (EXIF, GPS, etc.)</span>
                        </div>
                    </div>
                    
                    <div class="control-group">
                        <label>PNG Settings</label>
                        <select id="pngCompression">
                            <option value="auto">Auto compression (recommended)</option>
                            <option value="lossless">Lossless (best quality)</option>
                            <option value="lossy">Lossy (better compression)</option>
                        </select>
                    </div>
                    
                    <div class="control-group">
                        <label>Watermark</label>
                        <div class="watermark-control">
                            <input type="checkbox" id="enableWatermark">
                            <span>Add watermark to images</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-box" style="margin-top: 20px;">
                    <i class="fas fa-bolt"></i>
                    After setting parameters, click "Optimize Images" to start processing.
                </div>
                
                <button class="btn" id="processBtn">
                    <i class="fas fa-cogs"></i> Optimize Images
                </button>
            </div>
            
            <div class="card">
                <div class="section-title">
                    <i class="fas fa-tachometer-alt"></i>
                    <h2>Optimization Results</h2>
                </div>
                
                <div class="info-box">
                    <i class="fas fa-info-circle"></i>
                    Results will be displayed here after optimization. You can compare original and optimized images.
                </div>
                
                <div class="processing" id="processing">
                    <div class="spinner"></div>
                    <p>Processing images...</p>
                    <div class="progress-container">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <div class="progress-text" id="progressText">0%</div>
                </div>
                
                <div class="preview-section" id="previewSection">
                    <div class="stats" id="stats"></div>
                    
                    <div class="preview-container" id="previewContainer"></div>
                    
                    <div class="info-box" style="margin-top: 20px;">
                        <i class="fas fa-download"></i>
                        After optimization, you can download results or save settings for future use.
                    </div>
                    
                    <div class="buttons">
                        <button class="btn" id="downloadBtn" disabled>
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="btn btn-secondary" id="resetBtn">
                            <i class="fas fa-redo"></i> New Project
                        </button>
                        <button class="btn" id="saveSettingsBtn">
                            <i class="fas fa-save"></i> Save Profile
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="history-panel" id="historyPanel">
        <div class="history-header">
            <h3 class="history-title"><i class="fas fa-history"></i> Processing History</h3>
            <button class="close-history" id="closeHistory"><i class="fas fa-times"></i></button>
        </div>
        <div id="historyList">
            <p style="text-align: center; padding: 20px; color: var(--gray);">History is empty</p>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- Cropper.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Добавлена библиотека для работы с HEIC -->
    <script src="https://cdn.jsdelivr.net/npm/heic2any@0.0.3/dist/heic2any.min.js"></script>
    <!-- Добавлена библиотека для работы с TIFF -->
    <script src="https://cdn.jsdelivr.net/npm/tiff.js@1.0.0/tiff.min.js"></script>
    <script src="script.js"></script>
</body>
</html>